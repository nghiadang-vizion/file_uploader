{"ast":null,"code":"module.exports = Reader;\nvar fs = require('graceful-fs');\nvar Stream = require('stream').Stream;\nvar inherits = require('inherits');\nvar path = require('path');\nvar getType = require('./get-type.js');\nvar hardLinks = Reader.hardLinks = {};\nvar Abstract = require('./abstract.js');\n\n// Must do this *before* loading the child classes\ninherits(Reader, Abstract);\nvar LinkReader = require('./link-reader.js');\nfunction Reader(props, currentStat) {\n  var self = this;\n  if (!(self instanceof Reader)) return new Reader(props, currentStat);\n  if (typeof props === 'string') {\n    props = {\n      path: props\n    };\n  }\n\n  // polymorphism.\n  // call fstream.Reader(dir) to get a DirReader object, etc.\n  // Note that, unlike in the Writer case, ProxyReader is going\n  // to be the *normal* state of affairs, since we rarely know\n  // the type of a file prior to reading it.\n\n  var type;\n  var ClassType;\n  if (props.type && typeof props.type === 'function') {\n    type = props.type;\n    ClassType = type;\n  } else {\n    type = getType(props);\n    ClassType = Reader;\n  }\n  if (currentStat && !type) {\n    type = getType(currentStat);\n    props[type] = true;\n    props.type = type;\n  }\n  switch (type) {\n    case 'Directory':\n      ClassType = require('./dir-reader.js');\n      break;\n    case 'Link':\n    // XXX hard links are just files.\n    // However, it would be good to keep track of files' dev+inode\n    // and nlink values, and create a HardLinkReader that emits\n    // a linkpath value of the original copy, so that the tar\n    // writer can preserve them.\n    // ClassType = HardLinkReader\n    // break\n\n    case 'File':\n      ClassType = require('./file-reader.js');\n      break;\n    case 'SymbolicLink':\n      ClassType = LinkReader;\n      break;\n    case 'Socket':\n      ClassType = require('./socket-reader.js');\n      break;\n    case null:\n      ClassType = require('./proxy-reader.js');\n      break;\n  }\n  if (!(self instanceof ClassType)) {\n    return new ClassType(props);\n  }\n  Abstract.call(self);\n  if (!props.path) {\n    self.error('Must provide a path', null, true);\n  }\n  self.readable = true;\n  self.writable = false;\n  self.type = type;\n  self.props = props;\n  self.depth = props.depth = props.depth || 0;\n  self.parent = props.parent || null;\n  self.root = props.root || props.parent && props.parent.root || self;\n  self._path = self.path = path.resolve(props.path);\n  if (process.platform === 'win32') {\n    self.path = self._path = self.path.replace(/\\?/g, '_');\n    if (self._path.length >= 260) {\n      // how DOES one create files on the moon?\n      // if the path has spaces in it, then UNC will fail.\n      self._swallowErrors = true;\n      // if (self._path.indexOf(\" \") === -1) {\n      self._path = '\\\\\\\\?\\\\' + self.path.replace(/\\//g, '\\\\');\n      // }\n    }\n  }\n  self.basename = props.basename = path.basename(self.path);\n  self.dirname = props.dirname = path.dirname(self.path);\n\n  // these have served their purpose, and are now just noisy clutter\n  props.parent = props.root = null;\n\n  // console.error(\"\\n\\n\\n%s setting size to\", props.path, props.size)\n  self.size = props.size;\n  self.filter = typeof props.filter === 'function' ? props.filter : null;\n  if (props.sort === 'alpha') props.sort = alphasort;\n\n  // start the ball rolling.\n  // this will stat the thing, and then call self._read()\n  // to start reading whatever it is.\n  // console.error(\"calling stat\", props.path, currentStat)\n  self._stat(currentStat);\n}\nfunction alphasort(a, b) {\n  return a === b ? 0 : a.toLowerCase() > b.toLowerCase() ? 1 : a.toLowerCase() < b.toLowerCase() ? -1 : a > b ? 1 : -1;\n}\nReader.prototype._stat = function (currentStat) {\n  var self = this;\n  var props = self.props;\n  var stat = props.follow ? 'stat' : 'lstat';\n  // console.error(\"Reader._stat\", self._path, currentStat)\n  if (currentStat) process.nextTick(statCb.bind(null, null, currentStat));else fs[stat](self._path, statCb);\n  function statCb(er, props_) {\n    // console.error(\"Reader._stat, statCb\", self._path, props_, props_.nlink)\n    if (er) return self.error(er);\n    Object.keys(props_).forEach(function (k) {\n      props[k] = props_[k];\n    });\n\n    // if it's not the expected size, then abort here.\n    if (undefined !== self.size && props.size !== self.size) {\n      return self.error('incorrect size');\n    }\n    self.size = props.size;\n    var type = getType(props);\n    var handleHardlinks = props.hardlinks !== false;\n\n    // special little thing for handling hardlinks.\n    if (handleHardlinks && type !== 'Directory' && props.nlink && props.nlink > 1) {\n      var k = props.dev + ':' + props.ino;\n      // console.error(\"Reader has nlink\", self._path, k)\n      if (hardLinks[k] === self._path || !hardLinks[k]) {\n        hardLinks[k] = self._path;\n      } else {\n        // switch into hardlink mode.\n        type = self.type = self.props.type = 'Link';\n        self.Link = self.props.Link = true;\n        self.linkpath = self.props.linkpath = hardLinks[k];\n        // console.error(\"Hardlink detected, switching mode\", self._path, self.linkpath)\n        // Setting __proto__ would arguably be the \"correct\"\n        // approach here, but that just seems too wrong.\n        self._stat = self._read = LinkReader.prototype._read;\n      }\n    }\n    if (self.type && self.type !== type) {\n      self.error('Unexpected type: ' + type);\n    }\n\n    // if the filter doesn't pass, then just skip over this one.\n    // still have to emit end so that dir-walking can move on.\n    if (self.filter) {\n      var who = self._proxy || self;\n      // special handling for ProxyReaders\n      if (!self.filter.call(who, who, props)) {\n        if (!self._disowned) {\n          self.abort();\n          self.emit('end');\n          self.emit('close');\n        }\n        return;\n      }\n    }\n\n    // last chance to abort or disown before the flow starts!\n    var events = ['_stat', 'stat', 'ready'];\n    var e = 0;\n    (function go() {\n      if (self._aborted) {\n        self.emit('end');\n        self.emit('close');\n        return;\n      }\n      if (self._paused && self.type !== 'Directory') {\n        self.once('resume', go);\n        return;\n      }\n      var ev = events[e++];\n      if (!ev) {\n        return self._read();\n      }\n      self.emit(ev, props);\n      go();\n    })();\n  }\n};\nReader.prototype.pipe = function (dest) {\n  var self = this;\n  if (typeof dest.add === 'function') {\n    // piping to a multi-compatible, and we've got directory entries.\n    self.on('entry', function (entry) {\n      var ret = dest.add(entry);\n      if (ret === false) {\n        self.pause();\n      }\n    });\n  }\n\n  // console.error(\"R Pipe apply Stream Pipe\")\n  return Stream.prototype.pipe.apply(this, arguments);\n};\nReader.prototype.pause = function (who) {\n  this._paused = true;\n  who = who || this;\n  this.emit('pause', who);\n  if (this._stream) this._stream.pause(who);\n};\nReader.prototype.resume = function (who) {\n  this._paused = false;\n  who = who || this;\n  this.emit('resume', who);\n  if (this._stream) this._stream.resume(who);\n  this._read();\n};\nReader.prototype._read = function () {\n  this.error('Cannot read unknown type: ' + this.type);\n};","map":{"version":3,"names":["module","exports","Reader","fs","require","Stream","inherits","path","getType","hardLinks","Abstract","LinkReader","props","currentStat","self","type","ClassType","call","error","readable","writable","depth","parent","root","_path","resolve","process","platform","replace","length","_swallowErrors","basename","dirname","size","filter","sort","alphasort","_stat","a","b","toLowerCase","prototype","stat","follow","nextTick","statCb","bind","er","props_","Object","keys","forEach","k","undefined","handleHardlinks","hardlinks","nlink","dev","ino","Link","linkpath","_read","who","_proxy","_disowned","abort","emit","events","e","go","_aborted","_paused","once","ev","pipe","dest","add","on","entry","ret","pause","apply","arguments","_stream","resume"],"sources":["/Users/dangnghia/Documents/vizion/file-uploader/client/node_modules/fstream/lib/reader.js"],"sourcesContent":["module.exports = Reader\n\nvar fs = require('graceful-fs')\nvar Stream = require('stream').Stream\nvar inherits = require('inherits')\nvar path = require('path')\nvar getType = require('./get-type.js')\nvar hardLinks = Reader.hardLinks = {}\nvar Abstract = require('./abstract.js')\n\n// Must do this *before* loading the child classes\ninherits(Reader, Abstract)\n\nvar LinkReader = require('./link-reader.js')\n\nfunction Reader (props, currentStat) {\n  var self = this\n  if (!(self instanceof Reader)) return new Reader(props, currentStat)\n\n  if (typeof props === 'string') {\n    props = { path: props }\n  }\n\n  // polymorphism.\n  // call fstream.Reader(dir) to get a DirReader object, etc.\n  // Note that, unlike in the Writer case, ProxyReader is going\n  // to be the *normal* state of affairs, since we rarely know\n  // the type of a file prior to reading it.\n\n  var type\n  var ClassType\n\n  if (props.type && typeof props.type === 'function') {\n    type = props.type\n    ClassType = type\n  } else {\n    type = getType(props)\n    ClassType = Reader\n  }\n\n  if (currentStat && !type) {\n    type = getType(currentStat)\n    props[type] = true\n    props.type = type\n  }\n\n  switch (type) {\n    case 'Directory':\n      ClassType = require('./dir-reader.js')\n      break\n\n    case 'Link':\n    // XXX hard links are just files.\n    // However, it would be good to keep track of files' dev+inode\n    // and nlink values, and create a HardLinkReader that emits\n    // a linkpath value of the original copy, so that the tar\n    // writer can preserve them.\n    // ClassType = HardLinkReader\n    // break\n\n    case 'File':\n      ClassType = require('./file-reader.js')\n      break\n\n    case 'SymbolicLink':\n      ClassType = LinkReader\n      break\n\n    case 'Socket':\n      ClassType = require('./socket-reader.js')\n      break\n\n    case null:\n      ClassType = require('./proxy-reader.js')\n      break\n  }\n\n  if (!(self instanceof ClassType)) {\n    return new ClassType(props)\n  }\n\n  Abstract.call(self)\n\n  if (!props.path) {\n    self.error('Must provide a path', null, true)\n  }\n\n  self.readable = true\n  self.writable = false\n\n  self.type = type\n  self.props = props\n  self.depth = props.depth = props.depth || 0\n  self.parent = props.parent || null\n  self.root = props.root || (props.parent && props.parent.root) || self\n\n  self._path = self.path = path.resolve(props.path)\n  if (process.platform === 'win32') {\n    self.path = self._path = self.path.replace(/\\?/g, '_')\n    if (self._path.length >= 260) {\n      // how DOES one create files on the moon?\n      // if the path has spaces in it, then UNC will fail.\n      self._swallowErrors = true\n      // if (self._path.indexOf(\" \") === -1) {\n      self._path = '\\\\\\\\?\\\\' + self.path.replace(/\\//g, '\\\\')\n    // }\n    }\n  }\n  self.basename = props.basename = path.basename(self.path)\n  self.dirname = props.dirname = path.dirname(self.path)\n\n  // these have served their purpose, and are now just noisy clutter\n  props.parent = props.root = null\n\n  // console.error(\"\\n\\n\\n%s setting size to\", props.path, props.size)\n  self.size = props.size\n  self.filter = typeof props.filter === 'function' ? props.filter : null\n  if (props.sort === 'alpha') props.sort = alphasort\n\n  // start the ball rolling.\n  // this will stat the thing, and then call self._read()\n  // to start reading whatever it is.\n  // console.error(\"calling stat\", props.path, currentStat)\n  self._stat(currentStat)\n}\n\nfunction alphasort (a, b) {\n  return a === b ? 0\n    : a.toLowerCase() > b.toLowerCase() ? 1\n      : a.toLowerCase() < b.toLowerCase() ? -1\n        : a > b ? 1\n          : -1\n}\n\nReader.prototype._stat = function (currentStat) {\n  var self = this\n  var props = self.props\n  var stat = props.follow ? 'stat' : 'lstat'\n  // console.error(\"Reader._stat\", self._path, currentStat)\n  if (currentStat) process.nextTick(statCb.bind(null, null, currentStat))\n  else fs[stat](self._path, statCb)\n\n  function statCb (er, props_) {\n    // console.error(\"Reader._stat, statCb\", self._path, props_, props_.nlink)\n    if (er) return self.error(er)\n\n    Object.keys(props_).forEach(function (k) {\n      props[k] = props_[k]\n    })\n\n    // if it's not the expected size, then abort here.\n    if (undefined !== self.size && props.size !== self.size) {\n      return self.error('incorrect size')\n    }\n    self.size = props.size\n\n    var type = getType(props)\n    var handleHardlinks = props.hardlinks !== false\n\n    // special little thing for handling hardlinks.\n    if (handleHardlinks && type !== 'Directory' && props.nlink && props.nlink > 1) {\n      var k = props.dev + ':' + props.ino\n      // console.error(\"Reader has nlink\", self._path, k)\n      if (hardLinks[k] === self._path || !hardLinks[k]) {\n        hardLinks[k] = self._path\n      } else {\n        // switch into hardlink mode.\n        type = self.type = self.props.type = 'Link'\n        self.Link = self.props.Link = true\n        self.linkpath = self.props.linkpath = hardLinks[k]\n        // console.error(\"Hardlink detected, switching mode\", self._path, self.linkpath)\n        // Setting __proto__ would arguably be the \"correct\"\n        // approach here, but that just seems too wrong.\n        self._stat = self._read = LinkReader.prototype._read\n      }\n    }\n\n    if (self.type && self.type !== type) {\n      self.error('Unexpected type: ' + type)\n    }\n\n    // if the filter doesn't pass, then just skip over this one.\n    // still have to emit end so that dir-walking can move on.\n    if (self.filter) {\n      var who = self._proxy || self\n      // special handling for ProxyReaders\n      if (!self.filter.call(who, who, props)) {\n        if (!self._disowned) {\n          self.abort()\n          self.emit('end')\n          self.emit('close')\n        }\n        return\n      }\n    }\n\n    // last chance to abort or disown before the flow starts!\n    var events = ['_stat', 'stat', 'ready']\n    var e = 0\n    ;(function go () {\n      if (self._aborted) {\n        self.emit('end')\n        self.emit('close')\n        return\n      }\n\n      if (self._paused && self.type !== 'Directory') {\n        self.once('resume', go)\n        return\n      }\n\n      var ev = events[e++]\n      if (!ev) {\n        return self._read()\n      }\n      self.emit(ev, props)\n      go()\n    })()\n  }\n}\n\nReader.prototype.pipe = function (dest) {\n  var self = this\n  if (typeof dest.add === 'function') {\n    // piping to a multi-compatible, and we've got directory entries.\n    self.on('entry', function (entry) {\n      var ret = dest.add(entry)\n      if (ret === false) {\n        self.pause()\n      }\n    })\n  }\n\n  // console.error(\"R Pipe apply Stream Pipe\")\n  return Stream.prototype.pipe.apply(this, arguments)\n}\n\nReader.prototype.pause = function (who) {\n  this._paused = true\n  who = who || this\n  this.emit('pause', who)\n  if (this._stream) this._stream.pause(who)\n}\n\nReader.prototype.resume = function (who) {\n  this._paused = false\n  who = who || this\n  this.emit('resume', who)\n  if (this._stream) this._stream.resume(who)\n  this._read()\n}\n\nReader.prototype._read = function () {\n  this.error('Cannot read unknown type: ' + this.type)\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}