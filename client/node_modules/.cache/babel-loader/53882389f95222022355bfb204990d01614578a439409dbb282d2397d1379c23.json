{"ast":null,"code":"// Basically just a wrapper around an fs.readlink\n//\n// XXX: Enhance this to support the Link type, by keeping\n// a lookup table of {<dev+inode>:<path>}, so that hardlinks\n// can be preserved in tarballs.\n\nmodule.exports = LinkReader;\nvar fs = require('graceful-fs');\nvar inherits = require('inherits');\nvar Reader = require('./reader.js');\ninherits(LinkReader, Reader);\nfunction LinkReader(props) {\n  var self = this;\n  if (!(self instanceof LinkReader)) {\n    throw new Error('LinkReader must be called as constructor.');\n  }\n  if (!(props.type === 'Link' && props.Link || props.type === 'SymbolicLink' && props.SymbolicLink)) {\n    throw new Error('Non-link type ' + props.type);\n  }\n  Reader.call(self, props);\n}\n\n// When piping a LinkReader into a LinkWriter, we have to\n// already have the linkpath property set, so that has to\n// happen *before* the \"ready\" event, which means we need to\n// override the _stat method.\nLinkReader.prototype._stat = function (currentStat) {\n  var self = this;\n  fs.readlink(self._path, function (er, linkpath) {\n    if (er) return self.error(er);\n    self.linkpath = self.props.linkpath = linkpath;\n    self.emit('linkpath', linkpath);\n    Reader.prototype._stat.call(self, currentStat);\n  });\n};\nLinkReader.prototype._read = function () {\n  var self = this;\n  if (self._paused) return;\n  // basically just a no-op, since we got all the info we need\n  // from the _stat method\n  if (!self._ended) {\n    self.emit('end');\n    self.emit('close');\n    self._ended = true;\n  }\n};","map":{"version":3,"names":["module","exports","LinkReader","fs","require","inherits","Reader","props","self","Error","type","Link","SymbolicLink","call","prototype","_stat","currentStat","readlink","_path","er","linkpath","error","emit","_read","_paused","_ended"],"sources":["/Users/dangnghia/Documents/vizion/file-uploader/client/node_modules/fstream/lib/link-reader.js"],"sourcesContent":["// Basically just a wrapper around an fs.readlink\n//\n// XXX: Enhance this to support the Link type, by keeping\n// a lookup table of {<dev+inode>:<path>}, so that hardlinks\n// can be preserved in tarballs.\n\nmodule.exports = LinkReader\n\nvar fs = require('graceful-fs')\nvar inherits = require('inherits')\nvar Reader = require('./reader.js')\n\ninherits(LinkReader, Reader)\n\nfunction LinkReader (props) {\n  var self = this\n  if (!(self instanceof LinkReader)) {\n    throw new Error('LinkReader must be called as constructor.')\n  }\n\n  if (!((props.type === 'Link' && props.Link) ||\n    (props.type === 'SymbolicLink' && props.SymbolicLink))) {\n    throw new Error('Non-link type ' + props.type)\n  }\n\n  Reader.call(self, props)\n}\n\n// When piping a LinkReader into a LinkWriter, we have to\n// already have the linkpath property set, so that has to\n// happen *before* the \"ready\" event, which means we need to\n// override the _stat method.\nLinkReader.prototype._stat = function (currentStat) {\n  var self = this\n  fs.readlink(self._path, function (er, linkpath) {\n    if (er) return self.error(er)\n    self.linkpath = self.props.linkpath = linkpath\n    self.emit('linkpath', linkpath)\n    Reader.prototype._stat.call(self, currentStat)\n  })\n}\n\nLinkReader.prototype._read = function () {\n  var self = this\n  if (self._paused) return\n  // basically just a no-op, since we got all the info we need\n  // from the _stat method\n  if (!self._ended) {\n    self.emit('end')\n    self.emit('close')\n    self._ended = true\n  }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEAA,MAAM,CAACC,OAAO,GAAGC,UAAU;AAE3B,IAAIC,EAAE,GAAGC,OAAO,CAAC,aAAa,CAAC;AAC/B,IAAIC,QAAQ,GAAGD,OAAO,CAAC,UAAU,CAAC;AAClC,IAAIE,MAAM,GAAGF,OAAO,CAAC,aAAa,CAAC;AAEnCC,QAAQ,CAACH,UAAU,EAAEI,MAAM,CAAC;AAE5B,SAASJ,UAAUA,CAAEK,KAAK,EAAE;EAC1B,IAAIC,IAAI,GAAG,IAAI;EACf,IAAI,EAAEA,IAAI,YAAYN,UAAU,CAAC,EAAE;IACjC,MAAM,IAAIO,KAAK,CAAC,2CAA2C,CAAC;EAC9D;EAEA,IAAI,EAAGF,KAAK,CAACG,IAAI,KAAK,MAAM,IAAIH,KAAK,CAACI,IAAI,IACvCJ,KAAK,CAACG,IAAI,KAAK,cAAc,IAAIH,KAAK,CAACK,YAAa,CAAC,EAAE;IACxD,MAAM,IAAIH,KAAK,CAAC,gBAAgB,GAAGF,KAAK,CAACG,IAAI,CAAC;EAChD;EAEAJ,MAAM,CAACO,IAAI,CAACL,IAAI,EAAED,KAAK,CAAC;AAC1B;;AAEA;AACA;AACA;AACA;AACAL,UAAU,CAACY,SAAS,CAACC,KAAK,GAAG,UAAUC,WAAW,EAAE;EAClD,IAAIR,IAAI,GAAG,IAAI;EACfL,EAAE,CAACc,QAAQ,CAACT,IAAI,CAACU,KAAK,EAAE,UAAUC,EAAE,EAAEC,QAAQ,EAAE;IAC9C,IAAID,EAAE,EAAE,OAAOX,IAAI,CAACa,KAAK,CAACF,EAAE,CAAC;IAC7BX,IAAI,CAACY,QAAQ,GAAGZ,IAAI,CAACD,KAAK,CAACa,QAAQ,GAAGA,QAAQ;IAC9CZ,IAAI,CAACc,IAAI,CAAC,UAAU,EAAEF,QAAQ,CAAC;IAC/Bd,MAAM,CAACQ,SAAS,CAACC,KAAK,CAACF,IAAI,CAACL,IAAI,EAAEQ,WAAW,CAAC;EAChD,CAAC,CAAC;AACJ,CAAC;AAEDd,UAAU,CAACY,SAAS,CAACS,KAAK,GAAG,YAAY;EACvC,IAAIf,IAAI,GAAG,IAAI;EACf,IAAIA,IAAI,CAACgB,OAAO,EAAE;EAClB;EACA;EACA,IAAI,CAAChB,IAAI,CAACiB,MAAM,EAAE;IAChBjB,IAAI,CAACc,IAAI,CAAC,KAAK,CAAC;IAChBd,IAAI,CAACc,IAAI,CAAC,OAAO,CAAC;IAClBd,IAAI,CAACiB,MAAM,GAAG,IAAI;EACpB;AACF,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}