{"ast":null,"code":"function _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\n\n// XLSX does have \"d\" type for dates, but it's not commonly used.\n// Instead, it prefers using \"n\" type for storing dates as timestamps.\n//\n// Whether a numeric value is a number or a date timestamp, it sometimes could be\n// detected by looking at the value \"format\" and seeing if it's a date-specific one.\n// https://github.com/catamphetamine/read-excel-file/issues/3#issuecomment-395770777\n//\n// The list of generic numeric value \"formats\":\n// https://xlsxwriter.readthedocs.io/format.html#format-set-num-format\n//\nexport default function isDateTimestamp(styleId, styles, options) {\n  if (styleId) {\n    var style = styles[styleId];\n    if (!style) {\n      throw new Error(\"Cell style not found: \".concat(styleId));\n    }\n    if (!style.numberFormat) {\n      return false;\n    }\n    if (\n    // Whether it's a \"number format\" that's conventionally used for storing date timestamps.\n    BUILT_IN_DATE_NUMBER_FORMAT_IDS.indexOf(Number(style.numberFormat.id)) >= 0 ||\n    // Whether it's a \"number format\" that uses a \"formatting template\"\n    // that the developer is certain is a date formatting template.\n    options.dateFormat && style.numberFormat.template === options.dateFormat ||\n    // Whether the \"smart formatting template\" feature is not disabled\n    // and it has detected that it's a date formatting template by looking at it.\n    options.smartDateParser !== false && style.numberFormat.template && isDateTemplate(style.numberFormat.template)) {\n      return true;\n    }\n  }\n} // https://hexdocs.pm/xlsxir/number_styles.html\n\nvar BUILT_IN_DATE_NUMBER_FORMAT_IDS = [14, 15, 16, 17, 18, 19, 20, 21, 22, 27, 30, 36, 45, 46, 47, 50, 57]; // On some date formats, there's an \"[$-414]\" prefix.\n// I don't have any idea what that is.\n//\n// https://stackoverflow.com/questions/4730152/what-indicates-an-office-open-xml-cell-contains-a-date-time-value\n//\n// Examples:\n//\n// * 27 (built-in format) \"[$-404]e/m/d\"\n// * 164 (custom format) \"[$-414]mmmm\\ yyyy;@\"\n//\n\nvar DATE_FORMAT_WEIRD_PREFIX = /^\\[\\$-414\\]/; // On some date formats, there's an \";@\" postfix.\n// I don't have any idea what that is.\n// Examples:\n//\n// * 164 (custom format) \"m/d/yyyy;@\"\n// * 164 (custom format) \"[$-414]mmmm\\ yyyy;@\"\n//\n\nvar DATE_FORMAT_WEIRD_POSTFIX = /;@$/;\nfunction isDateTemplate(template) {\n  // Date format tokens could be in upper case or in lower case.\n  // There seems to be no single standard.\n  // So lowercase the template first.\n  template = template.toLowerCase(); // On some date formats, there's an \"[$-414]\" prefix.\n  // I don't have any idea what that is. Trim it.\n\n  template = template.replace(DATE_FORMAT_WEIRD_PREFIX, ''); // On some date formats, there's an \";@\" postfix.\n  // I don't have any idea what that is. Trim it.\n\n  template = template.replace(DATE_FORMAT_WEIRD_POSTFIX, '');\n  var tokens = template.split(/\\W+/);\n  for (var _iterator = _createForOfIteratorHelperLoose(tokens), _step; !(_step = _iterator()).done;) {\n    var token = _step.value;\n    if (DATE_TEMPLATE_TOKENS.indexOf(token) < 0) {\n      return false;\n    }\n  }\n  return true;\n} // These tokens could be in upper case or in lower case.\n// There seems to be no single standard, so using lower case.\n\nvar DATE_TEMPLATE_TOKENS = [\n// Seconds (min two digits). Example: \"05\".\n'ss',\n// Minutes (min two digits). Example: \"05\". Could also be \"Months\". Weird.\n'mm',\n// Hours. Example: \"1\".\n'h',\n// Hours (min two digits). Example: \"01\".\n'hh',\n// \"AM\" part of \"AM/PM\". Lowercased just in case.\n'am',\n// \"PM\" part of \"AM/PM\". Lowercased just in case.\n'pm',\n// Day. Example: \"1\"\n'd',\n// Day (min two digits). Example: \"01\"\n'dd',\n// Month (numeric). Example: \"1\".\n'm',\n// Month (numeric, min two digits). Example: \"01\". Could also be \"Minutes\". Weird.\n'mm',\n// Month (shortened month name). Example: \"Jan\".\n'mmm',\n// Month (full month name). Example: \"January\".\n'mmmm',\n// Two-digit year. Example: \"20\".\n'yy',\n// Full year. Example: \"2020\".\n'yyyy',\n// I don't have any idea what \"e\" means.\n// It's used in \"built-in\" XLSX formats:\n// * 27 '[$-404]e/m/d';\n// * 36 '[$-404]e/m/d';\n// * 50 '[$-404]e/m/d';\n// * 57 '[$-404]e/m/d';\n'e'];","map":{"version":3,"names":["isDateTimestamp","styleId","styles","options","style","Error","concat","numberFormat","BUILT_IN_DATE_NUMBER_FORMAT_IDS","indexOf","Number","id","dateFormat","template","smartDateParser","isDateTemplate","DATE_FORMAT_WEIRD_PREFIX","DATE_FORMAT_WEIRD_POSTFIX","toLowerCase","replace","tokens","split","_iterator","_createForOfIteratorHelperLoose","_step","done","token","value","DATE_TEMPLATE_TOKENS"],"sources":["/Users/dangnghia/Documents/vizion/file-uploader/client/node_modules/read-excel-file/source/read/isDateTimestamp.js"],"sourcesContent":["// XLSX does have \"d\" type for dates, but it's not commonly used.\r\n// Instead, it prefers using \"n\" type for storing dates as timestamps.\r\n//\r\n// Whether a numeric value is a number or a date timestamp, it sometimes could be\r\n// detected by looking at the value \"format\" and seeing if it's a date-specific one.\r\n// https://github.com/catamphetamine/read-excel-file/issues/3#issuecomment-395770777\r\n//\r\n// The list of generic numeric value \"formats\":\r\n// https://xlsxwriter.readthedocs.io/format.html#format-set-num-format\r\n//\r\nexport default function isDateTimestamp(styleId, styles, options) {\r\n  if (styleId) {\r\n    const style = styles[styleId]\r\n    if (!style) {\r\n      throw new Error(`Cell style not found: ${styleId}`)\r\n    }\r\n    if (!style.numberFormat) {\r\n      return false\r\n    }\r\n    if (\r\n      // Whether it's a \"number format\" that's conventionally used for storing date timestamps.\r\n      BUILT_IN_DATE_NUMBER_FORMAT_IDS.indexOf(Number(style.numberFormat.id)) >= 0 ||\r\n      // Whether it's a \"number format\" that uses a \"formatting template\"\r\n      // that the developer is certain is a date formatting template.\r\n      (options.dateFormat && style.numberFormat.template === options.dateFormat) ||\r\n      // Whether the \"smart formatting template\" feature is not disabled\r\n      // and it has detected that it's a date formatting template by looking at it.\r\n      (options.smartDateParser !== false && style.numberFormat.template && isDateTemplate(style.numberFormat.template))\r\n     ) {\r\n      return true\r\n    }\r\n  }\r\n}\r\n\r\n// https://hexdocs.pm/xlsxir/number_styles.html\r\nconst BUILT_IN_DATE_NUMBER_FORMAT_IDS = [14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57]\r\n\r\n// On some date formats, there's an \"[$-414]\" prefix.\r\n// I don't have any idea what that is.\r\n//\r\n// https://stackoverflow.com/questions/4730152/what-indicates-an-office-open-xml-cell-contains-a-date-time-value\r\n//\r\n// Examples:\r\n//\r\n// * 27 (built-in format) \"[$-404]e/m/d\"\r\n// * 164 (custom format) \"[$-414]mmmm\\ yyyy;@\"\r\n//\r\nconst DATE_FORMAT_WEIRD_PREFIX = /^\\[\\$-414\\]/\r\n\r\n// On some date formats, there's an \";@\" postfix.\r\n// I don't have any idea what that is.\r\n// Examples:\r\n//\r\n// * 164 (custom format) \"m/d/yyyy;@\"\r\n// * 164 (custom format) \"[$-414]mmmm\\ yyyy;@\"\r\n//\r\nconst DATE_FORMAT_WEIRD_POSTFIX = /;@$/\r\n\r\nfunction isDateTemplate(template) {\r\n  // Date format tokens could be in upper case or in lower case.\r\n  // There seems to be no single standard.\r\n  // So lowercase the template first.\r\n  template = template.toLowerCase()\r\n\r\n  // On some date formats, there's an \"[$-414]\" prefix.\r\n  // I don't have any idea what that is. Trim it.\r\n  template = template.replace(DATE_FORMAT_WEIRD_PREFIX, '')\r\n\r\n  // On some date formats, there's an \";@\" postfix.\r\n  // I don't have any idea what that is. Trim it.\r\n  template = template.replace(DATE_FORMAT_WEIRD_POSTFIX, '')\r\n\r\n  const tokens = template.split(/\\W+/)\r\n  for (const token of tokens) {\r\n    if (DATE_TEMPLATE_TOKENS.indexOf(token) < 0) {\r\n      return false\r\n    }\r\n  }\r\n  return true\r\n}\r\n\r\n// These tokens could be in upper case or in lower case.\r\n// There seems to be no single standard, so using lower case.\r\nconst DATE_TEMPLATE_TOKENS = [\r\n  // Seconds (min two digits). Example: \"05\".\r\n  'ss',\r\n  // Minutes (min two digits). Example: \"05\". Could also be \"Months\". Weird.\r\n  'mm',\r\n  // Hours. Example: \"1\".\r\n  'h',\r\n  // Hours (min two digits). Example: \"01\".\r\n  'hh',\r\n  // \"AM\" part of \"AM/PM\". Lowercased just in case.\r\n  'am',\r\n  // \"PM\" part of \"AM/PM\". Lowercased just in case.\r\n  'pm',\r\n  // Day. Example: \"1\"\r\n  'd',\r\n  // Day (min two digits). Example: \"01\"\r\n  'dd',\r\n  // Month (numeric). Example: \"1\".\r\n  'm',\r\n  // Month (numeric, min two digits). Example: \"01\". Could also be \"Minutes\". Weird.\r\n  'mm',\r\n  // Month (shortened month name). Example: \"Jan\".\r\n  'mmm',\r\n  // Month (full month name). Example: \"January\".\r\n  'mmmm',\r\n  // Two-digit year. Example: \"20\".\r\n  'yy',\r\n  // Full year. Example: \"2020\".\r\n  'yyyy',\r\n\r\n  // I don't have any idea what \"e\" means.\r\n  // It's used in \"built-in\" XLSX formats:\r\n  // * 27 '[$-404]e/m/d';\r\n  // * 36 '[$-404]e/m/d';\r\n  // * 50 '[$-404]e/m/d';\r\n  // * 57 '[$-404]e/m/d';\r\n  'e'\r\n];"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASA,eAATA,CAAyBC,OAAzB,EAAkCC,MAAlC,EAA0CC,OAA1C,EAAmD;EAChE,IAAIF,OAAJ,EAAa;IACX,IAAMG,KAAK,GAAGF,MAAM,CAACD,OAAD,CAApB;IACA,IAAI,CAACG,KAAL,EAAY;MACV,MAAM,IAAIC,KAAJ,0BAAAC,MAAA,CAAmCL,OAAnC,EAAN;IACD;IACD,IAAI,CAACG,KAAK,CAACG,YAAX,EAAyB;MACvB,OAAO,KAAP;IACD;IACD;IACE;IACAC,+BAA+B,CAACC,OAAhC,CAAwCC,MAAM,CAACN,KAAK,CAACG,YAAN,CAAmBI,EAApB,CAA9C,KAA0E,CAA1E;IACA;IACA;IACCR,OAAO,CAACS,UAAR,IAAsBR,KAAK,CAACG,YAAN,CAAmBM,QAAnB,KAAgCV,OAAO,CAACS,UAH/D;IAIA;IACA;IACCT,OAAO,CAACW,eAAR,KAA4B,KAA5B,IAAqCV,KAAK,CAACG,YAAN,CAAmBM,QAAxD,IAAoEE,cAAc,CAACX,KAAK,CAACG,YAAN,CAAmBM,QAApB,CARrF,EASG;MACD,OAAO,IAAP;IACD;EACF;AACF,C,CAED;;AACA,IAAML,+BAA+B,GAAG,CAAC,EAAD,EAAI,EAAJ,EAAO,EAAP,EAAU,EAAV,EAAa,EAAb,EAAgB,EAAhB,EAAmB,EAAnB,EAAsB,EAAtB,EAAyB,EAAzB,EAA4B,EAA5B,EAA+B,EAA/B,EAAkC,EAAlC,EAAqC,EAArC,EAAwC,EAAxC,EAA2C,EAA3C,EAA8C,EAA9C,EAAiD,EAAjD,CAAxC,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAMQ,wBAAwB,GAAG,aAAjC,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAMC,yBAAyB,GAAG,KAAlC;AAEA,SAASF,cAATA,CAAwBF,QAAxB,EAAkC;EAChC;EACA;EACA;EACAA,QAAQ,GAAGA,QAAQ,CAACK,WAAT,EAAX,CAJgC,CAMhC;EACA;;EACAL,QAAQ,GAAGA,QAAQ,CAACM,OAAT,CAAiBH,wBAAjB,EAA2C,EAA3C,CAAX,CARgC,CAUhC;EACA;;EACAH,QAAQ,GAAGA,QAAQ,CAACM,OAAT,CAAiBF,yBAAjB,EAA4C,EAA5C,CAAX;EAEA,IAAMG,MAAM,GAAGP,QAAQ,CAACQ,KAAT,CAAe,KAAf,CAAf;EACA,SAAAC,SAAA,GAAAC,+BAAA,CAAoBH,MAApB,GAAAI,KAAA,IAAAA,KAAA,GAAAF,SAAA,IAAAG,IAAA,GAA4B;IAAA,IAAjBC,KAAiB,GAAAF,KAAA,CAAAG,KAAA;IAC1B,IAAIC,oBAAoB,CAACnB,OAArB,CAA6BiB,KAA7B,IAAsC,CAA1C,EAA6C;MAC3C,OAAO,KAAP;IACD;EACF;EACD,OAAO,IAAP;AACD,C,CAED;AACA;;AACA,IAAME,oBAAoB,GAAG;AAC3B;AACA,IAF2B;AAG3B;AACA,IAJ2B;AAK3B;AACA,GAN2B;AAO3B;AACA,IAR2B;AAS3B;AACA,IAV2B;AAW3B;AACA,IAZ2B;AAa3B;AACA,GAd2B;AAe3B;AACA,IAhB2B;AAiB3B;AACA,GAlB2B;AAmB3B;AACA,IApB2B;AAqB3B;AACA,KAtB2B;AAuB3B;AACA,MAxB2B;AAyB3B;AACA,IA1B2B;AA2B3B;AACA,MA5B2B;AA8B3B;AACA;AACA;AACA;AACA;AACA;AACA,GApC2B,CAA7B"},"metadata":{},"sourceType":"module","externalDependencies":[]}