{"ast":null,"code":"var Traverse = require('traverse');\nvar EventEmitter = require('events').EventEmitter;\nmodule.exports = Chainsaw;\nfunction Chainsaw(builder) {\n  var saw = Chainsaw.saw(builder, {});\n  var r = builder.call(saw.handlers, saw);\n  if (r !== undefined) saw.handlers = r;\n  saw.record();\n  return saw.chain();\n}\n;\nChainsaw.light = function ChainsawLight(builder) {\n  var saw = Chainsaw.saw(builder, {});\n  var r = builder.call(saw.handlers, saw);\n  if (r !== undefined) saw.handlers = r;\n  return saw.chain();\n};\nChainsaw.saw = function (builder, handlers) {\n  var saw = new EventEmitter();\n  saw.handlers = handlers;\n  saw.actions = [];\n  saw.chain = function () {\n    var ch = Traverse(saw.handlers).map(function (node) {\n      if (this.isRoot) return node;\n      var ps = this.path;\n      if (typeof node === 'function') {\n        this.update(function () {\n          saw.actions.push({\n            path: ps,\n            args: [].slice.call(arguments)\n          });\n          return ch;\n        });\n      }\n    });\n    process.nextTick(function () {\n      saw.emit('begin');\n      saw.next();\n    });\n    return ch;\n  };\n  saw.pop = function () {\n    return saw.actions.shift();\n  };\n  saw.next = function () {\n    var action = saw.pop();\n    if (!action) {\n      saw.emit('end');\n    } else if (!action.trap) {\n      var node = saw.handlers;\n      action.path.forEach(function (key) {\n        node = node[key];\n      });\n      node.apply(saw.handlers, action.args);\n    }\n  };\n  saw.nest = function (cb) {\n    var args = [].slice.call(arguments, 1);\n    var autonext = true;\n    if (typeof cb === 'boolean') {\n      var autonext = cb;\n      cb = args.shift();\n    }\n    var s = Chainsaw.saw(builder, {});\n    var r = builder.call(s.handlers, s);\n    if (r !== undefined) s.handlers = r;\n\n    // If we are recording...\n    if (\"undefined\" !== typeof saw.step) {\n      // ... our children should, too\n      s.record();\n    }\n    cb.apply(s.chain(), args);\n    if (autonext !== false) s.on('end', saw.next);\n  };\n  saw.record = function () {\n    upgradeChainsaw(saw);\n  };\n  ['trap', 'down', 'jump'].forEach(function (method) {\n    saw[method] = function () {\n      throw new Error(\"To use the trap, down and jump features, please \" + \"call record() first to start recording actions.\");\n    };\n  });\n  return saw;\n};\nfunction upgradeChainsaw(saw) {\n  saw.step = 0;\n\n  // override pop\n  saw.pop = function () {\n    return saw.actions[saw.step++];\n  };\n  saw.trap = function (name, cb) {\n    var ps = Array.isArray(name) ? name : [name];\n    saw.actions.push({\n      path: ps,\n      step: saw.step,\n      cb: cb,\n      trap: true\n    });\n  };\n  saw.down = function (name) {\n    var ps = (Array.isArray(name) ? name : [name]).join('/');\n    var i = saw.actions.slice(saw.step).map(function (x) {\n      if (x.trap && x.step <= saw.step) return false;\n      return x.path.join('/') == ps;\n    }).indexOf(true);\n    if (i >= 0) saw.step += i;else saw.step = saw.actions.length;\n    var act = saw.actions[saw.step - 1];\n    if (act && act.trap) {\n      // It's a trap!\n      saw.step = act.step;\n      act.cb();\n    } else saw.next();\n  };\n  saw.jump = function (step) {\n    saw.step = step;\n    saw.next();\n  };\n}\n;","map":{"version":3,"names":["Traverse","require","EventEmitter","module","exports","Chainsaw","builder","saw","r","call","handlers","undefined","record","chain","light","ChainsawLight","actions","ch","map","node","isRoot","ps","path","update","push","args","slice","arguments","process","nextTick","emit","next","pop","shift","action","trap","forEach","key","apply","nest","cb","autonext","s","step","on","upgradeChainsaw","method","Error","name","Array","isArray","down","join","i","x","indexOf","length","act","jump"],"sources":["/Users/dangnghia/Documents/vizion/file-uploader/client/node_modules/chainsaw/index.js"],"sourcesContent":["var Traverse = require('traverse');\nvar EventEmitter = require('events').EventEmitter;\n\nmodule.exports = Chainsaw;\nfunction Chainsaw (builder) {\n    var saw = Chainsaw.saw(builder, {});\n    var r = builder.call(saw.handlers, saw);\n    if (r !== undefined) saw.handlers = r;\n    saw.record();\n    return saw.chain();\n};\n\nChainsaw.light = function ChainsawLight (builder) {\n    var saw = Chainsaw.saw(builder, {});\n    var r = builder.call(saw.handlers, saw);\n    if (r !== undefined) saw.handlers = r;\n    return saw.chain();\n};\n\nChainsaw.saw = function (builder, handlers) {\n    var saw = new EventEmitter;\n    saw.handlers = handlers;\n    saw.actions = [];\n\n    saw.chain = function () {\n        var ch = Traverse(saw.handlers).map(function (node) {\n            if (this.isRoot) return node;\n            var ps = this.path;\n\n            if (typeof node === 'function') {\n                this.update(function () {\n                    saw.actions.push({\n                        path : ps,\n                        args : [].slice.call(arguments)\n                    });\n                    return ch;\n                });\n            }\n        });\n\n        process.nextTick(function () {\n            saw.emit('begin');\n            saw.next();\n        });\n\n        return ch;\n    };\n\n    saw.pop = function () {\n        return saw.actions.shift();\n    };\n\n    saw.next = function () {\n        var action = saw.pop();\n\n        if (!action) {\n            saw.emit('end');\n        }\n        else if (!action.trap) {\n            var node = saw.handlers;\n            action.path.forEach(function (key) { node = node[key] });\n            node.apply(saw.handlers, action.args);\n        }\n    };\n\n    saw.nest = function (cb) {\n        var args = [].slice.call(arguments, 1);\n        var autonext = true;\n\n        if (typeof cb === 'boolean') {\n            var autonext = cb;\n            cb = args.shift();\n        }\n\n        var s = Chainsaw.saw(builder, {});\n        var r = builder.call(s.handlers, s);\n\n        if (r !== undefined) s.handlers = r;\n\n        // If we are recording...\n        if (\"undefined\" !== typeof saw.step) {\n            // ... our children should, too\n            s.record();\n        }\n\n        cb.apply(s.chain(), args);\n        if (autonext !== false) s.on('end', saw.next);\n    };\n\n    saw.record = function () {\n        upgradeChainsaw(saw);\n    };\n\n    ['trap', 'down', 'jump'].forEach(function (method) {\n        saw[method] = function () {\n            throw new Error(\"To use the trap, down and jump features, please \"+\n                            \"call record() first to start recording actions.\");\n        };\n    });\n\n    return saw;\n};\n\nfunction upgradeChainsaw(saw) {\n    saw.step = 0;\n\n    // override pop\n    saw.pop = function () {\n        return saw.actions[saw.step++];\n    };\n\n    saw.trap = function (name, cb) {\n        var ps = Array.isArray(name) ? name : [name];\n        saw.actions.push({\n            path : ps,\n            step : saw.step,\n            cb : cb,\n            trap : true\n        });\n    };\n\n    saw.down = function (name) {\n        var ps = (Array.isArray(name) ? name : [name]).join('/');\n        var i = saw.actions.slice(saw.step).map(function (x) {\n            if (x.trap && x.step <= saw.step) return false;\n            return x.path.join('/') == ps;\n        }).indexOf(true);\n\n        if (i >= 0) saw.step += i;\n        else saw.step = saw.actions.length;\n\n        var act = saw.actions[saw.step - 1];\n        if (act && act.trap) {\n            // It's a trap!\n            saw.step = act.step;\n            act.cb();\n        }\n        else saw.next();\n    };\n\n    saw.jump = function (step) {\n        saw.step = step;\n        saw.next();\n    };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}